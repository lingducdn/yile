(window.webpackJsonp=window.webpackJsonp||[]).push([["price_use"],{f789:function(e,t,i){"use strict";i.r(t),i("4160"),i("b0c0"),i("159b");var a={name:"PriceUse",data:function(){return{breadList:[{name:"密价管理",id:"1"},{name:"密价包使用",id:"2"}],total:0,form:{page:1,list_rows:10,customer_id:null},tableData:[],dialogTitle:"",dialogVisible:!1,ruleForm:{customer_id:null,close_price_package_id:null},rules:{close_price_package_id:[{required:!0,message:"请选择密价包",trigger:"change"}],customer_id:[{required:!0,message:"请输入会员编号",trigger:"blur"}]},options:[],theme_rgba:localStorage.getItem("theme_rgba")}},watch:{dialogVisible:function(e){e||(this.ruleForm={close_price_package_id:null,customer_id:null})},"form.customer_id":function(e){e||(this.form.customer_id=null)}},mounted:function(){this.getOptions(),this.getData()},methods:{getData:function(){var e=this;this.$http.closePricePackageUsePaging(this.form).then((function(t){0===t.code?(e.tableData=t.data.infos,e.total=t.data.count):e.$message({message:t.message,type:"error"})}))},getOptions:function(){var e=this;this.$http.closePricePackageList().then((function(t){0===t.code?e.options=t.data:e.$message({message:t.message,type:"error"})}))},pagination:function(e){this.form.page=e.page,this.form.list_rows=e.limit,this.getData()},add:function(){this.dialogTitle="添加密价包使用",this.dialogVisible=!0},edit:function(e){var t=this;this.dialogTitle="修改密价包使用",this.ruleForm.customer_id=e.customer_id,this.ruleForm.id=e.id,0!==this.options.length&&this.options.forEach((function(i){e.name===i.name&&(t.ruleForm.close_price_package_id=i.id)})),this.dialogVisible=!0},del:function(e){var t=this;this.$confirm("此操作将永久删除此条信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$http.closePricePackageUseDel({id:e}).then((function(e){0===e.code?(t.$message({message:"删除成功",type:"success"}),t.getData()):t.$message({message:e.message,type:"error"})}))}))},resetPopupData:function(e){this.$refs[e].resetFields(),this.dialogVisible=!1},submitPopupData:function(e){var t=this;this.$refs[e].validate((function(i){i&&("修改密价包使用"===t.dialogTitle?t.$http.closePricePackageUseEdit(t.ruleForm).then((function(i){0===i.code?(t.$message({message:"修改成功",type:"success"}),t.dialogVisible=!1,t.$refs[e].resetFields(),t.getData()):t.$message({message:i.message,type:"error"})})):"添加密价包使用"===t.dialogTitle&&t.$http.closePricePackageUseAdd(t.ruleForm).then((function(i){0===i.code?(t.$message({message:"添加成功",type:"success"}),t.dialogVisible=!1,t.$refs[e].resetFields(),t.getData()):t.$message({message:i.message,type:"error"})})))}))}}};i=i("2877"),i=Object(i.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"price_use"},[i("breadcrumb",{attrs:{"bread-list":e.breadList}}),i("el-card",{staticClass:"box-card"},[i("el-form",{attrs:{inline:!0,size:e.terminal}},[i("el-form-item",[i("el-input",{attrs:{placeholder:"会员编号",clearable:""},model:{value:e.form.customer_id,callback:function(t){e.$set(e.form,"customer_id",e._n(t))},expression:"form.customer_id"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.getData}},[e._v(" 搜索 ")]),i("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v(" 使用密价包 ")])],1)],1),[i("el-table",{staticStyle:{width:"100%"},attrs:{border:"",stripe:"","tooltip-effect":"light",data:e.tableData,"header-cell-style":{background:e.theme_rgba,color:"#363636"}}},[i("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"id",label:"编号"}}),i("el-table-column",{attrs:{"show-overflow-tooltip":"",width:"120",align:"center",prop:"name",label:"密价包名称"}}),i("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"customer_id",label:"会员编号"}}),i("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"account",label:"账号"}}),i("el-table-column",{attrs:{label:"创建时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("formatTimer")(t.row.create_time))+" ")]}}])}),i("el-table-column",{attrs:{label:"操作",width:"120",align:"center",fixed:"mini"!==e.terminal&&"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.edit(t.row)}}},[e._v(" 修改 ")]),i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.del(t.row.id)}}},[e._v(" 删除 ")])]}}])})],1)],10<e.total?i("pagination",{attrs:{total:e.total,page:e.form.page,limit:e.form.list_rows,"page-sizes":[10,20,50,100]},on:{"update:page":function(t){return e.$set(e.form,"page",t)},"update:limit":function(t){return e.$set(e.form,"list_rows",t)},pagination:e.pagination}}):e._e()],2),i("popup",{attrs:{"dialog-title":e.dialogTitle,visible:e.dialogVisible,"popup-width":"mini"===e.terminal?"100%":"550px"},on:{"update:visible":function(t){e.dialogVisible=t},resetPopupData:function(t){return e.resetPopupData("ruleForm")},submitPopupData:function(t){return e.submitPopupData("ruleForm")},handleClose:function(t){return e.resetPopupData("ruleForm")}}},[i("div",[i("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"请仔细检查,再进行操作!",type:"warning","show-icon":"",closable:!1}}),i("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"会员编号",prop:"customer_id"}},[i("el-input",{attrs:{placeholder:"会员编号"},model:{value:e.ruleForm.customer_id,callback:function(t){e.$set(e.ruleForm,"customer_id",e._n(t))},expression:"ruleForm.customer_id"}})],1),i("el-form-item",{attrs:{label:"密价包",prop:"close_price_package_id"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择密价包"},model:{value:e.ruleForm.close_price_package_id,callback:function(t){e.$set(e.ruleForm,"close_price_package_id",e._n(t))},expression:"ruleForm.close_price_package_id"}},e._l(e.options,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1)])],1)}),[],!1,null,null,null);t.default=i.exports}}]);