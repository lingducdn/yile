(window.webpackJsonp=window.webpackJsonp||[]).push([["ordinary_price"],{4273:function(e,t,r){"use strict";r.r(t);var l={name:"OrdinaryPrice",data:function(){return{breadList:[{name:"密价管理",id:"1"},{name:"普通密价",id:"2"}],form:{page:1,list_rows:10,customer_id:null},tableData:[],total:0,dialogTitle:"",dialogVisible:!1,dialogVisible1:!1,ruleForm:{goods_id:null,customer_id:null,type:1,cost_price:100,mark_up:null},rules:{goods_id:[{required:!0,message:"请输入商品编号",trigger:"blur"}],customer_id:[{required:!0,message:"请输入会员编号",trigger:"blur"}],type:[{required:!0,message:"请选择加价方式",trigger:"change"}],mark_up:[{required:!0,message:"请输入加价幅度",trigger:"blur"}]},theme_rgba:localStorage.getItem("theme_rgba")}},watch:{"form.customer_id":function(e){e||(this.form.customer_id=null)},dialogVisible:function(e){e||(this.ruleForm={goods_id:null,customer_id:null,type:1,cost_price:null,mark_up:null})},dialogVisible1:function(e){e||(this.ruleForm={goods_id:null,customer_id:null,type:1,cost_price:null,mark_up:null})}},mounted:function(){this.getData()},methods:{getData:function(){var e=this;this.$http.closePriceUsePaging(this.form).then((function(t){0===t.code?(e.tableData=t.data.infos,e.total=t.data.count):e.$message({message:t.message,type:"error"})}))},pagination:function(e){this.form.page=e.page,this.form.list_rows=e.limit,this.getData()},add:function(){this.dialogTitle="添加普通密价",this.dialogVisible=!0},add1:function(){this.dialogTitle="添加全局密价",this.dialogVisible1=!0},edit:function(e){this.ruleForm.id=e.id,this.ruleForm.type=e.type,this.ruleForm.mark_up=e.mark_up,this.ruleForm.goods_id=e.goods_id,this.ruleForm.customer_id=e.customer_id,this.ruleForm.customer_id=e.customer_id,e.goods_id?(this.dialogTitle="修改普通密价",this.dialogVisible=!0):(this.dialogTitle="修改全局密价",this.dialogVisible1=!0)},del:function(e){var t=this;this.$confirm("此操作将永久删除此条信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$http.closePriceUseDel({id:e}).then((function(e){0===e.code?(t.$message({message:"删除成功",type:"success"}),t.getData()):t.$message({message:e.message,type:"error"})}))}))},resetPopupData:function(e){this.$refs[e].resetFields(),this.ruleForm={goods_id:null,customer_id:null,type:1,cost_price:null,mark_up:null},this.dialogVisible=!1,this.dialogVisible1=!1},submitPopupData:function(e){var t=this;this.$refs[e].validate((function(r){r&&(t.ruleForm.cost_price=parseFloat(t.ruleForm.cost_price),t.ruleForm.mark_up=parseFloat(t.ruleForm.mark_up),"修改普通密价"===t.dialogTitle||"修改全局密价"===t.dialogTitle?t.$http.closePriceUseEdit(t.ruleForm).then((function(r){0===r.code?(t.$message({message:"修改成功",type:"success"}),t.dialogVisible=!1,t.dialogVisible1=!1,t.$refs[e].resetFields(),t.getData()):t.$message({message:r.message,type:"error"})})):"添加普通密价"!==t.dialogTitle&&"添加全局密价"!==t.dialogTitle||t.$http.closePriceUseAdd(t.ruleForm).then((function(r){0===r.code?(t.$message({message:"添加成功",type:"success"}),t.dialogVisible=!1,t.dialogVisible1=!1,t.$refs[e].resetFields(),t.getData()):t.$message({message:r.message,type:"error"})})))}))}}};r=r("2877"),r=Object(r.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"ordinary_price"},[r("breadcrumb",{attrs:{"bread-list":e.breadList}}),r("el-card",{staticClass:"box-card"},[r("el-form",{attrs:{inline:!0,size:e.terminal}},[r("el-form-item",[r("el-input",{attrs:{placeholder:"会员编号",clearable:""},model:{value:e.form.customer_id,callback:function(t){e.$set(e.form,"customer_id",e._n(t))},expression:"form.customer_id"}})],1),r("el-button",{attrs:{type:"primary",size:e.terminal},on:{click:e.getData}},[e._v(" 搜索 ")]),r("el-button",{attrs:{type:"primary",size:e.terminal},on:{click:e.add}},[e._v(" 普通密价 ")]),r("el-button",{attrs:{type:"primary",size:e.terminal},on:{click:e.add1}},[e._v(" 全局密价 ")]),r("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[r("div",{staticStyle:{color:"#F56C6C","line-height":"24px"}},[r("div",[e._v(" 全局密价: 指定某一个会员, 对其所有商品进行全局密价操作! ")]),r("div",[e._v(" 普通密价: 指定某一个会员的某个商品进行单独密价操作! ")]),r("div",[e._v(" 密价权限: 普通密价>密价包>全局密价 ")]),r("div",[e._v(" 举例: 全局密价加价1元, 普通密价加价3元. 普通密价权限比全局密价高, 实际加价为3元. ")])]),r("i",{staticClass:"el-icon-question",staticStyle:{cursor:"pointer","margin-left":"10px"},attrs:{slot:"reference"},slot:"reference"})])],1),[r("el-table",{staticStyle:{width:"100%"},attrs:{border:"",stripe:"","tooltip-effect":"light",data:e.tableData,"header-cell-style":{background:e.theme_rgba,color:"#363636"}}},[r("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"id",label:"密价编号"}}),r("el-table-column",{attrs:{label:"密价类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.goods_id?r("span",[e._v("普通密价")]):r("span",[e._v("全局密价")])]}}])}),r("el-table-column",{attrs:{label:"商品名称",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.goods_name||"--")+" ")]}}])}),r("el-table-column",{attrs:{label:"商品编号",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.goods_id||"--")+" ")]}}])}),r("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"customer_id",label:"会员编号"}}),r("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"account",label:"账号"}}),r("el-table-column",{attrs:{label:"加价幅度",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.mark_up)+" "),1===t.row.type?r("span",[e._v("%")]):e._e(),2===t.row.type?r("span",[e._v("元")]):e._e()]}}])}),r("el-table-column",{attrs:{label:"加价方式",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1===t.row.type?"按百分比加价":"按金额加价")+" ")]}}])}),r("el-table-column",{attrs:{label:"创建时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("formatTimer")(t.row.create_time))+" ")]}}])}),r("el-table-column",{attrs:{label:"操作",width:"120",align:"center",fixed:"mini"!==e.terminal&&"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text"},on:{click:function(r){return e.edit(t.row)}}},[e._v(" 修改 ")]),r("el-button",{staticStyle:{color:"#F56C6C"},attrs:{type:"text"},on:{click:function(r){return e.del(t.row.id)}}},[e._v(" 删除 ")])]}}])})],1)],10<e.total?r("pagination",{attrs:{total:e.total,page:e.form.page,limit:e.form.list_rows,"page-sizes":[10,20,50,100]},on:{"update:page":function(t){return e.$set(e.form,"page",t)},"update:limit":function(t){return e.$set(e.form,"list_rows",t)},pagination:e.pagination}}):e._e()],2),r("popup",{attrs:{"dialog-title":e.dialogTitle,visible:e.dialogVisible,"popup-width":"mini"===e.terminal?"100%":"550px"},on:{"update:visible":function(t){e.dialogVisible=t},resetPopupData:function(t){return e.resetPopupData("ruleForm")},submitPopupData:function(t){return e.submitPopupData("ruleForm")},handleClose:function(t){return e.resetPopupData("ruleForm")}}},[r("div",{staticClass:"ordinary_price1"},[r("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"请仔细检查,再进行操作!",type:"warning","show-icon":"",closable:!1}}),r("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"商品编号",prop:"goods_id"}},[r("el-input",{attrs:{placeholder:"商品编号"},model:{value:e.ruleForm.goods_id,callback:function(t){e.$set(e.ruleForm,"goods_id",e._n(t))},expression:"ruleForm.goods_id"}})],1),r("el-form-item",{attrs:{label:"会员编号",prop:"customer_id"}},[r("el-input",{attrs:{placeholder:"会员编号"},model:{value:e.ruleForm.customer_id,callback:function(t){e.$set(e.ruleForm,"customer_id",e._n(t))},expression:"ruleForm.customer_id"}})],1),r("el-form-item",{attrs:{label:"加价方式",prop:"type"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"加价方式"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",e._n(t))},expression:"ruleForm.type"}},[r("el-option",{attrs:{label:"百分比",value:1}}),r("el-option",{attrs:{label:"金 额",value:2}})],1)],1),r("el-divider"),r("el-form-item",{attrs:{label:"演示价格",prop:"cost_price"}},[r("el-input",{attrs:{placeholder:"演示价格",oninput:"value=value.replace(/[^0-9.]/g,'')"},model:{value:e.ruleForm.cost_price,callback:function(t){e.$set(e.ruleForm,"cost_price",t)},expression:"ruleForm.cost_price"}},[r("template",{slot:"append"},[e._v(" 元 (仅作为价格预览) ")])],2)],1),r("el-form-item",{attrs:{label:"加价幅度",prop:"mark_up"}},[r("el-input",{attrs:{placeholder:"加价幅度",oninput:"value=value.replace(/[^0-9.]/g,'')"},model:{value:e.ruleForm.mark_up,callback:function(t){e.$set(e.ruleForm,"mark_up",t)},expression:"ruleForm.mark_up"}},[1===e.ruleForm.type?r("template",{slot:"append"},[e._v(" 加价"+e._s(e.ruleForm.mark_up||0)+"% ")]):e._e(),2===e.ruleForm.type?r("template",{slot:"append"},[e._v(" 加价"+e._s(e.ruleForm.mark_up||0)+"元 ")]):e._e()],2)],1),r("el-form-item",{attrs:{label:"计算价格"}},[r("span",{staticStyle:{color:"#F56C6C"}},[e._v(" ¥ "),2===e.ruleForm.type?r("span",[e._v(e._s((parseFloat(e.ruleForm.cost_price)+parseFloat(e.ruleForm.mark_up)).toFixed(6)))]):e._e(),1===e.ruleForm.type?r("span",[e._v(e._s((parseFloat(e.ruleForm.cost_price)+parseFloat(e.ruleForm.cost_price)*(e.ruleForm.mark_up/100)).toFixed(6)))]):e._e()])])],1)],1)]),r("popup",{attrs:{"dialog-title":e.dialogTitle,visible:e.dialogVisible1,"popup-width":"mini"===e.terminal?"100%":"550px"},on:{"update:visible":function(t){e.dialogVisible1=t},resetPopupData:function(t){return e.resetPopupData("ruleForm")},submitPopupData:function(t){return e.submitPopupData("ruleForm")},handleClose:function(t){return e.resetPopupData("ruleForm")}}},[r("div",{staticClass:"ordinary_price1"},[r("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"请仔细检查,再进行操作!",type:"warning","show-icon":"",closable:!1}}),r("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"会员编号",prop:"customer_id"}},[r("el-input",{attrs:{placeholder:"会员编号"},model:{value:e.ruleForm.customer_id,callback:function(t){e.$set(e.ruleForm,"customer_id",e._n(t))},expression:"ruleForm.customer_id"}})],1),r("el-form-item",{attrs:{label:"加价方式",prop:"type"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"加价方式"},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",e._n(t))},expression:"ruleForm.type"}},[r("el-option",{attrs:{label:"百分比",value:1}}),r("el-option",{attrs:{label:"金 额",value:2}})],1)],1),r("el-divider"),r("el-form-item",{attrs:{label:"演示价格",prop:"cost_price"}},[r("el-input",{attrs:{placeholder:"演示价格",oninput:"value=value.replace(/[^0-9.]/g,'')"},model:{value:e.ruleForm.cost_price,callback:function(t){e.$set(e.ruleForm,"cost_price",t)},expression:"ruleForm.cost_price"}},[r("template",{slot:"append"},[e._v(" 元 (仅作为价格预览) ")])],2)],1),r("el-form-item",{attrs:{label:"加价幅度",prop:"mark_up"}},[r("el-input",{attrs:{placeholder:"加价幅度",oninput:"value=value.replace(/[^0-9.]/g,'')"},model:{value:e.ruleForm.mark_up,callback:function(t){e.$set(e.ruleForm,"mark_up",t)},expression:"ruleForm.mark_up"}},[1===e.ruleForm.type?r("template",{slot:"append"},[e._v(" 加价"+e._s(e.ruleForm.mark_up||0)+"% ")]):e._e(),2===e.ruleForm.type?r("template",{slot:"append"},[e._v(" 加价"+e._s(e.ruleForm.mark_up||0)+"元 ")]):e._e()],2)],1),r("el-form-item",{attrs:{label:"计算价格"}},[r("span",{staticStyle:{color:"#F56C6C"}},[e._v(" ¥ "),2===e.ruleForm.type?r("span",[e._v(e._s((parseFloat(e.ruleForm.cost_price)+parseFloat(e.ruleForm.mark_up)).toFixed(6)))]):e._e(),1===e.ruleForm.type?r("span",[e._v(e._s((parseFloat(e.ruleForm.cost_price)+parseFloat(e.ruleForm.cost_price)*(e.ruleForm.mark_up/100)).toFixed(6)))]):e._e()])])],1)],1)])],1)}),[],!1,null,null,null);t.default=r.exports}}]);