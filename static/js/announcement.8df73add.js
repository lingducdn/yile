(window.webpackJsonp=window.webpackJsonp||[]).push([["announcement"],{"9f85":function(t,e,l){"use strict";l.r(e);var o={name:"Announcement",data:function(){return{tableData:[],form:{page:1,list_rows:10,substation_id:null},total:0,dialogTitle:"",dialogVisible:!1,ruleForm:{id:null,type:1,title:"",content:"",always:1},theme_rgba:localStorage.getItem("theme_rgba"),rules:{title:[{required:!0,message:"请输入公告标题",trigger:"blur"}],content:[{required:!0,message:"请输入公告内容",trigger:"blur"}]}}},watch:{"ruleForm.type":function(){this.ruleForm.content=""},dialogVisible:function(t){t||(this.ruleForm={id:null,type:1,title:"",content:"",always:1})},"form.substation_id":function(t){t||0===t||(this.form.substation_id=null)}},mounted:function(){this.getData()},methods:{getData:function(){var t=this;this.$http.noticeManagePaging(this.form).then((function(e){0===e.code?(t.total=e.data.count,t.tableData=e.data.infos):t.$message.error(e.message)}))},pagination:function(t){this.form.page=t.page,this.form.list_rows=t.limit,this.getData()},add:function(){this.dialogTitle="新增公告",this.dialogVisible=!0},edit:function(t){var e=this;this.dialogTitle="修改公告",this.ruleForm.title=t.title,this.ruleForm.type=t.type,this.ruleForm.id=t.id,this.ruleForm.content=t.content,this.ruleForm.always=t.always,this.$nextTick((function(){e.ruleForm.content=t.content})),this.dialogVisible=!0},editorHtml:function(t){this.ruleForm.content=t.txt.html()},resetPopupData:function(){this.dialogVisible=!1,this.ruleForm={image:"",title:"",url:"",id:null}},submitPopupData:function(t){var e=this;this.$refs[t].validate((function(t){t&&("新增公告"===e.dialogTitle?e.$http.noticeManageAdd(e.ruleForm).then((function(t){0===t.code?(e.$message({message:"保存成功",type:"success"}),e.dialogVisible=!1,e.getData()):e.$message({message:t.message,type:"error"})})):e.$http.noticeManageEdit(e.ruleForm).then((function(t){0===t.code?(e.$message({message:"修改成功",type:"success"}),e.dialogVisible=!1,e.getData()):e.$message({message:t.message,type:"error"})})))}))},del:function(t){var e=this;this.$confirm("此操作将永久删除此条信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$http.noticeManageDel({id:t}).then((function(t){0===t.code?(e.$message({message:"删除成功",type:"success"}),e.getData()):e.$message({message:t.message,type:"error"})}))}))}}};l=l("2877"),l=Object(l.a)(o,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"announcement"},[l("el-card",{staticClass:"box-card"},[l("el-form",{attrs:{inline:"",size:t.terminal?"mini":"medium"}},[l("el-form-item",[l("el-button",{attrs:{type:"primary"},on:{click:t.add}},[t._v(" 新增公告 ")])],1)],1),l("el-table",{staticStyle:{width:"100%"},attrs:{border:"",stripe:"","tooltip-effect":"light",data:t.tableData,"header-cell-style":{background:t.theme_rgba,color:"#363636"}}},[l("el-table-column",{attrs:{align:"center",prop:"id",label:"编号",width:"110"}}),l("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"title",label:"公告标题"}}),l("el-table-column",{attrs:{label:"公告类型",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(1===e.row.type?"滚动公告":"弹窗公告")+" ")]}}])}),l("el-table-column",{attrs:{label:"发布时间",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatTimer")(e.row.create_time))+" ")]}}])}),l("el-table-column",{attrs:{label:"公告内容",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.type?l("span",[t._v(t._s(e.row.content))]):l("span",[l("el-popover",{attrs:{trigger:"hover"}},[l("div",{staticStyle:{padding:"30px 20px"},domProps:{innerHTML:t._s(e.row.content)}}),l("span",{staticStyle:{color:"#409EFF",cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[t._v("查看")])])],1)]}}])}),l("el-table-column",{attrs:{label:"操作",width:"160",align:"center",fixed:"mini"!==t.terminal&&"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-button",{attrs:{type:"text"},on:{click:function(l){return t.edit(e.row)}}},[t._v(" 修改 ")]),l("el-button",{staticStyle:{color:"#F56C6C"},attrs:{type:"text"},on:{click:function(l){return t.del(e.row.id)}}},[t._v(" 删除 ")])]}}])})],1),10<t.total?l("pagination",{attrs:{total:t.total,page:t.form.page,limit:t.form.list_rows,"page-sizes":[10,20,50,100]},on:{"update:page":function(e){return t.$set(t.form,"page",e)},"update:limit":function(e){return t.$set(t.form,"list_rows",e)},pagination:t.pagination}}):t._e(),l("popup",{attrs:{"dialog-title":t.dialogTitle,visible:t.dialogVisible,"popup-width":"mini"===t.terminal?"100%":"800px"},on:{"update:visible":function(e){t.dialogVisible=e},resetPopupData:t.resetPopupData,submitPopupData:function(e){return t.submitPopupData("ruleForm")},handleClose:t.resetPopupData}},[l("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"80px"}},[l("el-form-item",{attrs:{label:"公告类型"}},[l("el-radio-group",{attrs:{size:"small"},model:{value:t.ruleForm.type,callback:function(e){t.$set(t.ruleForm,"type",e)},expression:"ruleForm.type"}},[l("el-radio-button",{attrs:{label:1}},[t._v(" 滚动公告 ")]),l("el-radio-button",{attrs:{label:2}},[t._v(" 弹窗公告 ")])],1)],1),2===t.ruleForm.type?l("el-form-item",{attrs:{label:"弹出频率"}},[l("el-radio-group",{attrs:{size:"small"},model:{value:t.ruleForm.always,callback:function(e){t.$set(t.ruleForm,"always",e)},expression:"ruleForm.always"}},[l("el-radio-button",{attrs:{label:1}},[t._v(" 每次都弹出 ")]),l("el-radio-button",{attrs:{label:2}},[t._v(" 只弹出一次 ")])],1)],1):t._e(),l("el-form-item",{attrs:{label:"公告标题",prop:"title"}},[l("el-input",{attrs:{placeholder:"公告标题"},model:{value:t.ruleForm.title,callback:function(e){t.$set(t.ruleForm,"title",e)},expression:"ruleForm.title"}})],1),l("el-form-item",{attrs:{label:"公告内容",prop:"content"}},[1===t.ruleForm.type?l("div",[l("el-input",{attrs:{placeholder:"公告内容"},model:{value:t.ruleForm.content,callback:function(e){t.$set(t.ruleForm,"content",e)},expression:"ruleForm.content"}})],1):l("div",[l("editor",{ref:"editorHtml",attrs:{"editor-data":t.ruleForm.content},on:{editorHtml:t.editorHtml}})],1)])],1)],1)],1)],1)}),[],!1,null,null,null);e.default=l.exports}}]);