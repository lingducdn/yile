(window.webpackJsonp=window.webpackJsonp||[]).push([["set"],{"2ae8":function(e,t,a){"use strict";a.r(t),a("4160"),a("b0c0"),a("159b"),a("96cf");var r=a("1da1"),o={name:"Set",data:function(){return{activeName:"a",form3:{page:1,list_rows:10},form5:{status:0,balance:0},loginInfo:[],dataInfo:null,form:{name:"",photo:"",mobile:"",qq:""},form1:{old_password:"",new_password:"",re_new_password:""},rules:{name:[{required:!0,message:"请输入昵称",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"}],qq:[{required:!0,message:"请输入QQ号",trigger:"blur"}]},rules1:{old_password:[{required:!0,message:"请输入原密码",trigger:"blur"}],new_password:[{required:!0,message:"请输入新密码",trigger:"blur"}],re_new_password:[{required:!0,message:"请重复输入密码",trigger:"blur"}]},rules3:{lid:[{required:!0,message:"请选择会员等级",trigger:"blur"}],num:[{required:!0,message:"请输入购买时长",trigger:"blur"}]},rules4:{lid:[{required:!0,message:"请选择会员等级",trigger:"blur"}]},rules5:{balance:[{required:!0,message:"请输入额度",trigger:"blur"}]},url:"/api/customer/profile/upload",dialogTitle1:"",dialogVisible1:!1,options:[],options1:[],price:null,ruleForm1:{lid:null},showData:{},loading:!1,isprice:0,isprice1:0,theme_rgba:localStorage.getItem("theme_rgba"),theme_name:localStorage.getItem("theme_name")}},watch:{dialogVisible1:function(){var e=this;this.options1.forEach((function(t){e.showData.level===t.index&&(t.price?e.isprice1=t.price:e.isprice1=0)}))}},mounted:function(){var e=this;this.getData(),this.getData1(),this.$http.getSubstation().then((function(t){1===t.code?(e.dataInfo=!0,e.activeName="d"):e.dataInfo=!1})),this.getOptions()},methods:{pagination:function(e){this.form3.page=e.page,this.form3.list_rows=e.limit,this.getData1()},getData1:function(){var e=this;this.$http.loginRecord(this.form3).then((function(t){0===t.code&&(e.loginInfo=t.data.infos)}))},forceSocialLogin:function(e){var t=this;this.$confirm("是否确认"+(2===e?"关闭":"开启")+"强制使用QQ登录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$http.forceSocialLogin({status:e}).then((function(a){0===a.code?(t.showData.force_social_login=e,t.$message({message:"保存成功",type:"success"}),t.$parent.getData()):t.$message.error(a.message)}))}))},delBind:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$confirm("是否确认解绑?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$http.delBind().then((function(t){0===t.code?(e.$message({message:"解绑成功",type:"success"}),e.showData.openid="",e.$parent.getData()):e.$message.error(t.message)}))}));case 1:case"end":return t.stop()}}),t)})))()},getData:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$parent.showData;case 2:return a=t.sent,e.showData=a,e.form.name=a.name,e.form.qq=a.qq,e.form.mobile=a.mobile,e.form5=a.config.mail,t.next=10,e.getOptions();case 10:case"end":return t.stop()}}),t)})))()},calculate:function(e){var t=this;this.options.forEach((function(a){e===a.index&&(t.isprice=a.price)}))},submitForm:function(){var e=this;this.$refs.form.validate((function(t){t&&e.$confirm("是否确认保存?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$http.profileEdit(e.form).then((function(t){0===t.code?(e.$message({message:"修改成功",type:"success"}),e.$router.push({path:"/blank",query:{page:"/set"}})):e.$message.error(t.message)}))}))}))},submitForm1:function(){var e=this;this.$refs.form1.validate((function(t){if(t){if(e.form1.new_password!==e.form1.re_new_password)return e.$message.error("两次密码不一致"),!1;e.$confirm("是否确认修改密码?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$http.editPassword(e.form1).then((function(t){0===t.code?(e.$message({message:"修改成功",type:"success"}),localStorage.removeItem("data"),e.$router.push({path:"/login"})):e.$message.error(t.message)}))}))}}))},handleAvatarSuccess:function(e){0===e.code?this.form.photo=e.data:this.$message({message:e.message,type:"error"})},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;e=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG和PNG 格式!"),e||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&e},resetPopupData1:function(){this.dialogVisible1=!1,this.dialogVisible1=!1},submitPopupData1:function(){var e=this;this.$http.upgradeLevel(this.ruleForm1).then((function(t){0===t.code?(e.$message({message:"升级成功",type:"success"}),e.dialogVisible1=!1,e.getOptions(),e.$router.push({path:"/blank",query:{page:"/set"}})):e.$message.error(t.message)}))},getOptions:function(){var e,t=JSON.parse(localStorage.getItem("sysConfig"));for(e in this.options=[],this.options1=[],t.customer_level)this.showData.level<e&&this.options.push({index:parseInt(e),as:t.customer_level[e].as,price:t.customer_level[e].price}),this.options1.push({index:parseInt(e),as:t.customer_level[e].as,price:t.customer_level[e].price})},qqLogin:function(){window.location.href="/social/login/qq"},submitForm5:function(){var e=this;this.$refs.form5.validate((function(t){t&&e.$confirm("是否确认保存?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$http.setMailConfig(e.form5).then((function(t){0===t.code?e.$message({message:"保存成功",type:"success"}):e.$message.error(t.message)}))}))}))}}};a("8eb1"),a=a("2877"),a=Object(a.a)(o,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"set"},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[e.dataInfo?a("el-tab-pane",{attrs:{label:"个人等级",name:"d"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],class:e.theme_name,staticStyle:{width:"987px",height:"118px","border-radius":"5px",position:"relative"}},[a("div",{staticStyle:{"padding-left":"30px","padding-top":"35px","font-weight":"500",color:"#fff"}},[e.showData.level?a("div",e._l(e.options1,(function(t){return a("div",{key:t.index},[e.showData.level===t.index?a("span",[e._v("会员等级: "+e._s(t.as))]):e._e()])})),0):e._e(),a("el-row",[a("el-col",{attrs:{span:4}},[a("div",{staticStyle:{padding:"10px 0 20px 0"}},[a("span",[e._v("到期时间: 永久会员")])])]),a("el-col",{attrs:{span:20}},[1===e.showData.level||2===e.showData.level||3===e.showData.level?a("el-button",{staticStyle:{padding:"7px 20px",color:"#5388FF","font-weight":"600","margin-top":"6px"},attrs:{round:"",size:"mini"},on:{click:function(t){e.dialogVisible1=!0,e.dialogTitle1="升级会员"}}},[e._v(" 升 级 ")]):e._e()],1)],1)],1)])]):e._e(),a("el-tab-pane",{attrs:{label:"账号设置",name:"a"}},[a("div",{staticStyle:{width:"360px"}},[a("el-form",{ref:"form",attrs:{"label-width":"80px",model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"账号"}},[a("el-input",{attrs:{disabled:""},model:{value:e.showData.account,callback:function(t){e.$set(e.showData,"account",t)},expression:"showData.account"}})],1),a("el-form-item",{attrs:{label:"昵称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("el-input",{model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),a("el-form-item",{attrs:{label:"QQ号",prop:"qq"}},[a("el-input",{model:{value:e.form.qq,callback:function(t){e.$set(e.form,"qq",t)},expression:"form.qq"}})],1),a("el-form-item",{attrs:{label:"头像"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.url,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.photo?a("img",{staticClass:"avatar",attrs:{src:e.form.photo}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.submitForm("form")}}},[e._v(" 保存 ")])],1)],1)],1)]),a("el-tab-pane",{attrs:{label:"修改密码",name:"b"}},[a("div",{staticStyle:{width:"360px"}},[a("el-form",{ref:"form1",attrs:{"label-width":"100px",model:e.form1,rules:e.rules1}},[a("el-form-item",{attrs:{label:"原密码",prop:"old_password"}},[a("el-input",{model:{value:e.form1.old_password,callback:function(t){e.$set(e.form1,"old_password",t)},expression:"form1.old_password"}})],1),a("el-form-item",{attrs:{label:"新密码",prop:"new_password"}},[a("el-input",{model:{value:e.form1.new_password,callback:function(t){e.$set(e.form1,"new_password",t)},expression:"form1.new_password"}})],1),a("el-form-item",{attrs:{label:"重复新密码",prop:"re_new_password"}},[a("el-input",{model:{value:e.form1.re_new_password,callback:function(t){e.$set(e.form1,"re_new_password",t)},expression:"form1.re_new_password"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.submitForm1("form1")}}},[e._v(" 修改 ")])],1)],1)],1)]),a("el-tab-pane",{attrs:{label:"三方账号",name:"c"}},[a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"绑定QQ"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{type:"primary",plain:"",value:e.showData.openid?e.showData.nickname:"未绑定",disabled:""}}),e.showData.openid?a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",plain:""},on:{click:e.delBind}},[e._v(" 解绑 ")]):a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",plain:""},on:{click:function(t){return e.qqLogin()}}},[e._v(" 绑定 ")])],1),a("el-form-item",{attrs:{label:"强制QQ登录"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{value:1===e.showData.force_social_login?"已开启":"已关闭",disabled:""}}),2===e.showData.force_social_login?a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",plain:""},on:{click:function(t){return e.forceSocialLogin(1)}}},[e._v(" 开启 ")]):a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",plain:""},on:{click:function(t){return e.forceSocialLogin(2)}}},[e._v(" 关闭 ")])],1)],1),a("div",{staticStyle:{color:"#F8393E","font-size":"12px","line-height":"20px","margin-left":"10px"}},[e._v(" 注: 开启强制QQ登录后，将只能通过绑定QQ进行快捷登录，无法在输入帐号密码登录，保证账户安全！ ")])],1),a("el-tab-pane",{attrs:{label:"登录记录",name:"e"}},[a("el-table",{staticClass:"table_style",staticStyle:{width:"100%"},attrs:{border:"",stripe:"","tooltip-effect":"light",data:e.loginInfo,"header-cell-style":{background:e.theme_rgba,color:"#363636"}}},[a("el-table-column",{attrs:{label:"登录方式",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s("web"===t.row.type?"网页":"QQ快捷"))])]}}])}),a("el-table-column",{attrs:{align:"center",prop:"ip",label:"IP地址"}}),a("el-table-column",{attrs:{label:"登录时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatTimer")(t.row.create_time)))])]}}])})],1),10<e.total?a("pagination",{attrs:{total:e.total,page:e.form3.page,limit:e.form3.list_rows,"page-sizes":[10,20,50,100]},on:{"update:page":function(t){return e.$set(e.form3,"page",t)},"update:limit":function(t){return e.$set(e.form3,"list_rows",t)},pagination:e.pagination}}):e._e()],1),a("el-tab-pane",{attrs:{label:"邮箱通知",name:"f"}},[a("div",{staticStyle:{width:"360px"}},[a("el-form",{ref:"form5",attrs:{model:e.form5,rules:e.rules5,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"通知状态",prop:"status"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.form5.status,callback:function(t){e.$set(e.form5,"status",e._n(t))},expression:"form5.status"}},[a("el-radio-button",{attrs:{label:1}},[e._v(" 开启 ")]),a("el-radio-button",{attrs:{label:0}},[e._v(" 关闭 ")])],1)],1),a("el-form-item",{attrs:{label:"最低余额",prop:"balance"}},[a("el-input",{model:{value:e.form5.balance,callback:function(t){e.$set(e.form5,"balance",e._n(t))},expression:"form5.balance"}}),a("div",{staticStyle:{color:"#999","font-size":"13px"}},[e._v(" 当余额低于最低余额,进行邮件通知 ")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.submitForm5("form5")}}},[e._v(" 保存 ")])],1)],1)],1)])],1),a("popup",{attrs:{"dialog-title":e.dialogTitle1,visible:e.dialogVisible1,"popup-width":"500px"},on:{"update:visible":function(t){e.dialogVisible1=t},resetPopupData:e.resetPopupData1,submitPopupData:e.submitPopupData1,handleClose:e.resetPopupData1}},[a("div",[a("el-alert",{staticStyle:{"margin-bottom":"20px"},attrs:{title:"升级会员, 请仔细核对信息,再进行操作!",type:"warning","show-icon":"",closable:!1}}),a("el-form",{ref:"ruleForm1",attrs:{model:e.ruleForm1,rules:e.rules4,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"升级等级",prop:"lid"}},[a("el-select",{staticStyle:{width:"78%"},on:{change:e.calculate},model:{value:e.ruleForm1.lid,callback:function(t){e.$set(e.ruleForm1,"lid",e._n(t))},expression:"ruleForm1.lid"}},e._l(e.options,(function(e,t){return a("el-option",{key:t,attrs:{label:e.as,value:e.index}})})),1),e._l(e.options,(function(t){return a("span",{key:t.index,staticStyle:{display:"inline-block",transform:"translate(10px)"}},[t.index===e.ruleForm1.lid?a("span",[e._v("¥"+e._s(t.price)+"元")]):e._e()])}))],2),a("div",[e._v(" 需支付费用(补差价): "),a("span",{staticStyle:{color:"#ee0a24","font-size":"16px"}},[0<e.isprice-e.isprice1?a("span",[e._v(" ¥"+e._s(e.isprice-e.isprice1)+".00元 ")]):a("span",[e._v("--")])])])],1)],1)])],1)}),[],!1,null,null,null);t.default=a.exports},"6daf":function(e,t,a){},"8eb1":function(e,t,a){"use strict";var r=a("6daf");a.n(r).a}}]);